'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _createClass=(function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}})();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function');}}var V=(function(){function V(){_classCallCheck(this,V);this._cfg={nonvoid:function nonvoid(v,bool){if(bool){return v.trim()?0:['nonvoid']}else{return 0}},reg:function reg(v,_reg){return _reg.test(v)?0:['reg']},limit:function limit(v,interval){return+v>=interval[0]&&+v<=interval[1]?0:['limit']},equal:function equal(v,target){return v==target?0:['equal']},unequal:function unequal(v,target){return v!=target?0:['unequal']}};this._regList={ImgCode:/^[0-9a-zA-Z]{4}$/,SmsCode:/^\d{4}$/,MailCode:/^\d{4}$/,UserName:/^[\w|\d]{4,16}$/,Password:/^[\w!@#$%^&*.]{6,16}$/,Mobile:/^1[3|5|8]\d{9}$/,RealName:/^[\u4e00-\u9fa5 ]{2,10}$/,BankNum:/^\d{10,19}$/,Money:/^([1-9]\d*|0)$/,Answer:/^\S+$/,Mail:/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/};this._ERR_MSG={nonvoid:'该项要求不能为空值',reg:'格式错误',limit:'您输入的值不在区间内',equal:'两次输入的值不相等',unequal:'两次输入的值重复'}}_createClass(V,[{key:'install',value:function install(Vue,options){var self=this;Vue.directive('cddv-input',{bind:function bind(el,binding,vnode){var ves=0;var v={value:binding.value||'',arg:binding.arg||''};var vm=vnode.context,cddv=vm._cddv;if(!el._cddv){el._cddv={dirty:false,v_type:v.arg,indeed_value:v.value.format,validated:false,msg:'未进行验证',title:v.value.title}}if(!cddv.forms[v.value.id])cddv.forms[v.value.id]=el;el.onchange=function(){if(!el._cddv.dirty)el._cddv.dirty=true;ves=cddv.check(v,el,vm);cddv.msg(v,el,ves);vm.$emit('cddv-checked')}}});Vue.directive('cddv-msg',{bind:function bind(el,binding,vnode){var v={arg:binding.arg};var vm=vnode.context;el.style.display='none';var listener=vm._cddv.forms[v.arg];vm.$on('cddv-checked',function(){if(listener._cddv.validated){el.style.display='none'}else if(!listener._cddv.validated&&listener._cddv.dirty){el.style.display='block';el.innerHTML=listener._cddv.msg}})}});Vue.directive('cddv-final-check',{bind:function bind(el,binding,vnode){var v={arg:binding.arg||'',value:binding.value||''};var vm=vnode.context;vm.$on('cddv-checked',function(){var validated=true;if(v.value.keys){validated=v.value.keys.every(function(item,index){return vm._cddv.forms[item]._cddv.validated})}else{console.log(vm._cddv.forms);for(var item in vm._cddv.forms){if(item=='undefined'){continue}else{if(!vm._cddv.forms[item]._cddv.validated){validated=false;break}}}}var className=el.className.split(' ');if(!validated){el.onclick=function(){};if(className.indexOf('submit-check-failed')==-1){className.push('submit-check-failed')}el.className=className.join(' ')}else{className.pop();el.className=className.join(' ');if(v.arg){el.onclick=vm[v.arg]}else el.onclick=v.value.method}})}});Vue.prototype._cddv={forms:{},check:function check(v,el,vm){if(v.arg=='reg'){if(self._regList[v.value.format]){v.value.format=self._regList[v.value.format]}}var checkValue=v.value.aim||vm.$data[v.value.aim]||el.value;return self.cfg[v.arg](checkValue,v.value.format)},msg:function msg(v,el,ves){var str='';switch(ves[0]){case'nonvoid':str='['+v.value.title+']';el._cddv.validated=false;el._cddv.msg=str+self._ERR_MSG[ves];break;case'reg':str="["+v.value.title+']格式错误';el._cddv.validated=false;el._cddv.msg=str;break;case'limit':str=+el.value<v.value.format[0]?'['+v.value.title+']应该大于'+v.value.format[0]:'['+v.value.title+']应该小于'+v.value.format[1];el._cddv.validated=false;el._cddv.msg=self._ERR_MSG[ves]+str;break;case'equal':str="["+v.value.title+']';el._cddv.validated=false;el._cddv.msg=str+self._ERR_MSG[ves];break;case'unequal':str='['+v.value.title+']';el._cddv.validated=false;el._cddv.msg=str+self._ERR_MSG[ves];break;default:el._cddv.validated=true;el._cddv.msg="["+v.value.title+"]验证通过"}},value:function value(){return this}}}},{key:'ERR_MSG',get:function get(){return this._ERR_MSG}},{key:'cfg',get:function get(){return this._cfg}},{key:'regList',get:function get(){return this._regList}}]);return V})();exports['default']=new V();module.exports=exports['default'];